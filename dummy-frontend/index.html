<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session Creation</title>
    <!-- Bootstrap CSS from CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="container">

<h1 class="mt-4">Session Creation</h1>

<div id="sessionInfo" class="mt-4" style="display: none;">
    <p class="lead">Creating session: <span id="sessionId"></span></p>
    <p class="lead">Redirecting in: <span id="countdown"></span> seconds</p>
</div>

<form id="sessionForm" class="mt-4">
    <!-- You can add more input fields if needed -->
    <button type="button" class="btn btn-primary" onclick="createSession()">Create Session</button>
</form>

<script>
    function createSession() {
        // Use Axios for the HTTP request
        axios.post("http://localhost:8080/api/sessions")
            .then(function (response) {
                // Display session ID
                let sessionIdElement = document.getElementById("sessionId");
                sessionIdElement.textContent = response.data.id;

                // Store session id in local storage
                localStorage.setItem("sessionId", response.data.id);

                // Show the session info div
                let sessionInfoDiv = document.getElementById("sessionInfo");
                sessionInfoDiv.style.display = "block";

                // Countdown timer
                let countdownElement = document.getElementById("countdown");
                let countdown = 3; // Set the initial countdown time in seconds

                function updateCountdown() {
                    countdownElement.textContent = countdown;
                    if (countdown > 0) {
                        countdown--;
                        setTimeout(updateCountdown, 1000); // Update every second
                    } else {
                        // Redirect to session id after countdown
                        window.location.href = "./game.html?sessionId=" + response.data.id;
                    }
                }

                // Start the countdown
                updateCountdown();
            })
            .catch(function (error) {
                console.error("Error creating session:", error);
            });
    }
</script>

<!-- Bootstrap JS and Popper.js (required for Bootstrap) from CDN -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
</body>
</html>
